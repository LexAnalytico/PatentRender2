Root cause and fix

Why 3 (Patent Application Filing) is showing 0

The code first looks up service ID by name in services. In your DB, “Patent Application Filing” exists as id=2.
Your pricing rules for filing are stored under service_id=3 (per db_schema/tables).
Result: the code fetches rules for service_id=2 (because name lookup succeeded), but the filing keys live under service_id=3, so no matching keys are found and the total is 0.
Why 4 (First Examination Response) is showing 0

The code falls back to service_id=4 for First Examination Response.
Your services table doesn’t have id=4. If you have a foreign key from service_pricing_rules.service_id -> services.id, rows for service_id=4 won’t exist or won’t be reachable; if they do exist without FK, you still want a matching services row to keep data consistent.
If the rules for First Examination Response are under service_id=4 (as shown in db_schema/tables), but the services table lacks that service row, align it.
What to change in the database (recommended alignment)

Make the services table match the UI names and the rule sets:

Rename services to align with the UI and rules
id=1 → name: 'Patentability Search' (was 'Patent Search & Analysis')
id=2 → name: 'Drafting' (was 'Patent Application Filing')
id=3 → name: 'Patent Application Filing' (was 'Patent Portfolio Management')
Insert id=4 → name: 'First Examination Response'
Example SQL

UPDATE services SET name='Patentability Search', description='Patentability search and analysis' WHERE id=1;
UPDATE services SET name='Drafting', description='Provisional/Complete/PS-CS drafting' WHERE id=2;
UPDATE services SET name='Patent Application Filing', description='Filing – Provisional/CS/PS-CS/PCT' WHERE id=3;
INSERT INTO services (id, category_id, name, base_price, description) VALUES (4, 1, 'First Examination Response', 0, 'Response preparation within required timeframes') ON CONFLICT (id) DO NOTHING;
Ensure service_pricing_rules are attached to the correct service_id
Drafting keys must be under service_id=2:
provisional_specification_standard|expediated|rush
complete_specification_standard|expediated|rush
ps_cs_standard|expediated|rush
Patent Application Filing keys must be under service_id=3:
provisional_filing, complete_specification_filing, ps_cs_filing, pct_filing
First Examination Response keys must be under service_id=4:
base_fee, response_due_anytime_after_15_days, response_due_within_11_15_days, response_due_within_4_10_days
Optional but recommended: add professional_fee rows
If you want the preview’s “Professional Fee” line to be non-zero, add a key='professional_fee' per application_type for each of the services. The calculator will always add it if present.
Why this fixes the problem

After alignment:
“Patent Application Filing” resolves to service_id=3 and finds the correct filing keys (non-zero).
“First Examination Response” resolves to service_id=4 and finds the FER keys (non-zero).
Drafting remains at id=2 with its drafting-turnaround keys.
Patentability Search remains at id=1 with its search+turnaround keys.
Notes on the code side (already handled)

The pricing engine now falls back to any available application_type if a rule for the selected application_type is missing. This avoids zeros due to application_type only.
Filing keys and FER keys are explicitly supported by the pricing engine, and the options UI sets the correct values used as keys.
Conclusion

Update services names/IDs per the mapping above and ensure service_pricing_rules rows are attached to:
id=2 for Drafting, id=3 for Patent Application Filing, id=4 for First Examination Response.
Insert services.id=4 if it’s missing.
Optionally add professional_fee rows to improve the breakdown display.
With these DB corrections, 3 and 4 will compute non-zero totals immediately without further code changes.